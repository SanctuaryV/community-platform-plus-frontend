pipeline {
    agent any

    stages {
        stage('Checkout Code') {
            steps {
                cleanWs()
                checkout scm
            }
        }
        
        stage("install dependencies") {
            steps{
                sh'''
                  echo "Installing dependencies..."
                 npm install
                '''
            }
        }
        stage('Build Frontend') {
            steps {
                sh '''
                echo "Building frontend..."
                npm run build
                '''
            }
        }
        
        stage('SAST - Checkmarx') {
              when {
                expression { return params.Run_Checkmarx == true }
            }
            steps{
                checkmarxASTScanner additionalOptions: '--project-groups intern  --scan-types "sast,sca"', 
        baseAuthUrl: '', branchName: "add/pipeline", checkmarxInstallation: 'Checkmarx', credentialsId: '', 
        projectName: "SanctuaryV/community-platform-plus-frontend", serverUrl: '', tenantName: '', useOwnAdditionalOptions: true
            }
        
    }

            }
}